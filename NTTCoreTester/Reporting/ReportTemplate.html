<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <title>{{FILE_PREFIX}} – Test Report</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0
        }

        body {
            font-family: 'Segoe UI',sans-serif;
            background: #f0f2f5;
            color: #222
        }

        .hdr {
            background: linear-gradient(135deg,#0f0c29,#302b63,#24243e);
            color: #fff;
            padding: 22px 30px
        }

            .hdr h1 {
                font-size: 1.5rem;
                font-weight: 600
            }

            .hdr p {
                font-size: .8rem;
                color: #bbb;
                margin-top: 5px
            }

        .cards {
            display: flex;
            gap: 14px;
            padding: 20px 30px;
            flex-wrap: wrap
        }

        .card {
            background: #fff;
            border-radius: 10px;
            padding: 14px 22px;
            min-width: 130px;
            box-shadow: 0 2px 8px rgba(0,0,0,.08);
            text-align: center
        }

            .card .n {
                font-size: 2rem;
                font-weight: 700
            }

            .card .l {
                font-size: .7rem;
                color: #888;
                text-transform: uppercase;
                letter-spacing: .5px;
                margin-top: 3px
            }

        .c-total .n {
            color: #334
        }

        .c-pass .n {
            color: #16a34a
        }

        .c-sfail .n {
            color: #dc2626
        }

        .c-pfail .n {
            color: #d97706
        }

        .filters {
            padding: 0 30px 14px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center
        }

            .filters input, .filters select {
                padding: 7px 11px;
                border: 1px solid #ddd;
                border-radius: 6px;
                font-size: .82rem;
                outline: none;
                background: #fff
            }

                .filters input:focus, .filters select:focus {
                    border-color: #6366f1
                }

        .wrap {
            padding: 0 30px 30px;
            overflow-x: auto
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: #fff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,.08);
            font-size: .8rem
        }

        thead tr {
            background: #0f0c29;
            color: #fff
        }

        thead th {
            padding: 11px 13px;
            text-align: left;
            white-space: nowrap;
            font-weight: 500
        }

        tbody tr {
            border-bottom: 1px solid #f0f0f0;
            transition: background .12s
        }

            tbody tr:hover {
                background: #f7f8ff
            }

        tbody td {
            padding: 9px 13px;
            vertical-align: top
        }

        .row-pass {
            border-left: 3px solid #22c55e
        }

        .row-fail {
            border-left: 3px solid #ef4444
        }

        .badge {
            display: inline-block;
            padding: 2px 9px;
            border-radius: 20px;
            font-size: .72rem;
            font-weight: 600
        }

        .b-valid {
            background: #dcfce7;
            color: #16a34a
        }

        .b-invalid {
            background: #fee2e2;
            color: #dc2626
        }

        .b-pass {
            background: #dcfce7;
            color: #16a34a
        }

        .b-fail {
            background: #fee2e2;
            color: #dc2626
        }

        .ep {
            font-family: monospace;
            font-size: .78rem;
            color: #6366f1;
            font-weight: 600
        }

        .mono {
            font-family: monospace;
            font-size: .78rem
        }

        .muted {
            color: #aaa;
            font-size: .75rem
        }

        .err-box {
            background: #fff8f8;
            border: 1px solid #fca5a5;
            border-radius: 6px;
            padding: 7px;
            max-height: 110px;
            overflow-y: auto;
            font-size: .72rem;
            color: #dc2626;
            white-space: pre-wrap;
            word-break: break-all
        }

        .btn-view {
            background: #6366f1;
            color: #fff;
            border: none;
            border-radius: 6px;
            padding: 4px 11px;
            cursor: pointer;
            font-size: .75rem;
            transition: background .2s
        }

            .btn-view:hover {
                background: #4f46e5
            }

            .btn-view.open {
                background: #ef4444
            }

        .json-box {
            margin-top: 7px;
            background: #1e1e2e;
            color: #cdd6f4;
            border-radius: 8px;
            padding: 11px;
            max-height: 420px;
            overflow: auto
        }

            .json-box pre {
                font-size: .72rem;
                white-space: pre-wrap;
                word-break: break-all
            }
    </style>
</head>
<body>

    <div class='hdr'>
        <h1>🧪 API Test Report — {{FILE_PREFIX}}</h1>
        <p>Generated: {{GENERATED_TIME}} | Performance Threshold: {{PERF_THRESHOLD}} ms</p>
    </div>

    <div class='cards'>
        <div class='card c-total'><div class='n'>{{TOTAL}}</div><div class='l'>Total</div></div>
        <div class='card c-pass'> <div class='n'>{{FULL_PASS}}</div><div class='l'>Full Pass</div></div>
        <div class='card c-sfail'><div class='n'>{{SCHEMA_FAIL}}</div><div class='l'>Schema Fail</div></div>
        <div class='card c-pfail'><div class='n'>{{PERF_FAIL}}</div><div class='l'>Perf Fail</div></div>
    </div>

    <div class='filters'>
        <span>🔍</span>
        <input id='fEp' placeholder='Filter endpoint…' oninput='filter()'>
        <select id='fSchema' onchange='filter()'>
            <option value=''>All Schema</option>
            <option>VALID</option>
            <option>INVALID</option>
        </select>
        <select id='fPerf' onchange='filter()'>
            <option value=''>All Perf</option>
            <option>PASS</option>
            <option>FAIL</option>
        </select>
        <select id='fHttp' onchange='filter()'>
            <option value=''>All HTTP</option>
            <option>200</option>
            <option>400</option>
            <option>401</option>
            <option>500</option>
        </select>
        <button onclick='resetFilters()'
                style='padding:7px 13px;border:1px solid #ddd;border-radius:6px;
           background:#fff;cursor:pointer;font-size:.82rem'>
            Reset
        </button>
    </div>

    <div class='wrap'>
        <table>
            <thead>
                <tr>
                    <th>Timestamp</th>
                    <th>Endpoint</th>
                    <th>Resp Time</th>
                    <th>Perf</th>
                    <th>HTTP</th>
                    <th>Message</th>
                    <th>Business Status</th>
                    <th>Schema</th>
                    <th>Validation Errors</th>
                    <th>Response JSON</th>
                </tr>
            </thead>
            <tbody id='tbody'>{{TABLE_ROWS}}</tbody>
        </table>
    </div>

    <script>
function toggle(btn, id) {
  const box = document.getElementById(id);
  const open = box.style.display === 'none';
  box.style.display = open ? 'block' : 'none';
  btn.textContent   = open ? '▼ Hide' : '▶ View';
  btn.classList.toggle('open', open);
}

function filter() {
  const ep     = document.getElementById('fEp').value.toLowerCase();
  const schema = document.getElementById('fSchema').value;
  const perf   = document.getElementById('fPerf').value;
  const http   = document.getElementById('fHttp').value;

  document.querySelectorAll('#tbody tr').forEach(r => {
    const ok =
      (!ep     || r.dataset.endpoint.includes(ep)) &&
      (!schema || r.dataset.schema === schema)      &&
      (!perf   || r.dataset.perf   === perf)        &&
      (!http   || r.dataset.http   === http);
    r.style.display = ok ? '' : 'none';
  });
}

function resetFilters() {
  ['fEp','fSchema','fPerf','fHttp'].forEach(id => {
    const el = document.getElementById(id);
    el.tagName === 'INPUT' ? el.value = '' : el.selectedIndex = 0;
  });
  filter();
}
    </script>
</body>
</html>

